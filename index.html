<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>color-transform</title>
	<script src="https://unpkg.com/vue@2.2.4/dist/vue.min.js"></script>
	<style>
		.color {
		    width: 20px;
		    height: 20px;
		    border:1px solid #CCC;
		}
	</style>
</head>
<body>
	<div id="app">
		<div class="input">
			<div class="color" :style="{'background':input}" v-if="data.type"></div>
			<input type="text" v-model="input" @blur="inputChange">
			<label for="white">white</label><input type="radio" name="bg" v-model="bg" id="white" value="255" @change="inputChange">
			<label for="black">black</label><input type="radio" name="bg" v-model="bg" id="black" value="0" @change="inputChange">
		</div>
		<div class="output">
			<div class="type" v-for="it in result"><div class="color" :style="{'background':it}"></div>{{it}}</div>
		</div>
	</div>
	<script>
		var app = new Vue({
		  el: '#app',
		  data: {
		    input: '',
		    data:{},
		    bg:'255',
		    result:[]
		  },
		  methods: {
		    inputChange: function () {
		      this.result = [];
		      var data = this.data = this.getType();
		      if (data && data.type == 'hex') {
		      	this.result.push('rgb('+data.r+','+data.g+','+data.b+')')
		      }else if(data && data.type == 'rgb'){
		      	this.result.push('#'+data.r+data.g+data.b)
		      }else if(data && data.type == 'rgba'){
		      	var rgbaData = this.rgba();
		      	this.result.push('rgb('+rgbaData.r.toFixed(0)+','+rgbaData.g.toFixed(0)+','+rgbaData.b.toFixed(0)+')')
		      	this.result.push('#'+parseInt(rgbaData.r).toString(16)+parseInt(rgbaData.g).toString(16)+parseInt(rgbaData.b).toString(16))
		      }
		    },
		    getType: function(){
		    	var data;
		    	var input = this.input;
		    	var regHex = /^#([0-9a-fA-f]{2})([0-9a-fA-f]{2})([0-9a-fA-f]{2})/,
		    		regRgba = /^rgba\(([0-9]{1,3}),([0-9]{1,3}),([0-9]{1,3}),(1|0.[0-9]*|.[0-9]*)\)/,
		    		regRgb = /^rgb\(([0-9]{1,3}),([0-9]{1,3}),([0-9]{1,3})\)/
		    	if (data = input.match(regHex)) {
		    		return {
		    			type:'hex',
		    			r:parseInt(data[1],16).toString(10),
		    			g:parseInt(data[2],16).toString(10),
		    			b:parseInt(data[3],16).toString(10)
		    		}
		    	}else if(data = input.match(regRgb)){
		    		return {
		    			type:'rgb',
		    			r:parseInt(data[1]).toString(16),
		    			g:parseInt(data[2]).toString(16),
		    			b:parseInt(data[3]).toString(16)
		    		}
		    	}else if(data = input.match(regRgba)){
		    		return {
		    			type:'rgba',
		    			r:Number(data[1]),
		    			g:Number(data[2]),
		    			b:Number(data[3]),
		    			a:Number(data[4])
		    		}
		    	}else{
		    		return {}
		    	}
		    },
		    rgba(){
		    	var data = this.data;
		    	var bg = Number(this.bg);
		    	return {
		    		r:((1 - data.a) * bg) + (data.a * data.r),
		    		g:((1 - data.a) * bg) + (data.a * data.g),
		    		b:((1 - data.a) * bg) + (data.a * data.b)
		    	}
		    }
		  }
		})
	</script>
</body>
</html>